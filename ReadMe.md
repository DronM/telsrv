## Сервер приема телематических данных от GPS/ГЛОНАСС трекеров.<br/>
<br/>
Реализованы протоколы: **ArusNavi** (внутренний протокол), **Репорт системы**. Хранилище данных организовано на базе **Postgresql**.<br/>
Набор запускаемых серверов определяется структурами в настроечном файле **telsrv.json**.<br/>
Структура *arnavi* определяет сервер для приема сообщений от трекров "ArusNavi".<br/>
Структура *reportsyst* определяет сервер для приема сообщений от трекров "Репорт системы".<br/>
Есть возможно добавления произвольных типов трекеров и протоколов. Добавляемый протокол должен реализовывать интерфейс ClientSocketer, определенный в app/ClientSocketList.go.<br/>
Подключение новых протоколов осуществляется при запуске приложения и требует перекомпиляции программы.<br/>
<br/>
Имеется возможность добавления любых хранилищ данных, произвольных запросов SQL.<br/>
В варианте хранилища на базе **Postgresql** реализовано динамически настраиваемое количество соединений с базой данных. Для доступа к данным используется пакет pgx (github.com/jackc/pgx).<br/>
Структура запроса для базы данных определна в функции *getQuery()* хранилища.<br/>
При невозможности установить подключение к базе данных запросы логируются в файл. При восстановлении подключения запросы из файла будут выполнены, файл удален.<br/>
<br/>
Ведется статистика для каждого сервера. Есть возможноть получить следующую информацию:<br/>
- *clientCount* - количество подключенных клиентов
- *runTime* - время от запуска
- *clientMaxCount* - максимальное кличество клиентских подключений
- *downloadedBytes* - объем скаченной информации сервером
- *uploadedBytes* - объем отправленной информации серверу
- *list* - показывает всех клиентов
- *handshakes* - количество произошедших подключений
- *status* - текущий статус сервера
<br/>
Команды, требующие IMEI устройства:<br/>
- *imeiRunTime*
- *imeiDownloadedBytes*
- *imeiUploadedBytes*
- *imeiHandshakes*
- *imeiStatus*
<br/>	
Для **ArusNavi** реализованы специфичные команды, требующие IMEI устройства:<br/>
- *transmitCoords*
- *updateSoftwareForce*
- *updateSoftware*
- *reset*
- *downloadSettingsFromWebConf*
- *sendSettingsToWebConf*
<br/>
В каталоге client имеется клиентская программа, реализующая подключение к серверу по протоколу TCP. Команды отправляются на выбранный сервер, получение результата в консоль.<br/>
Пример запуска консольной программы для запроса количества подключенных устройств (имеется рабочий сервер на хосте 192.168.1.77:52053 с заданным ключом):<br/>
*./client 192.168.1.77:52053 eg419rh4t14mn4s54tgr7g1 clientCount*

##### Перед компиляцией и запуском:
При запуске настройки читаются из файла *telsrv.json*. Возможно установить следующие параметры:<br/>
- Структура *arnavi* определяет параметры для сервера **ArusNavi** (хост, порт, время простоя соединения, секунд)
- Структура *reportsyst* определяет параметры для сервера **Репорт системы** (хост, порт, время простоя соединения, секунд)
- Параметр *processCount* устанавливает количество параллельных процессов соединения с базой данных
- *storageConnection* - строка соединения с базой данных.
- *logLevel* - уровень лога debug/warn/info/error
- *commandKey* - ключ, который бедут ожидаться от консольного клиента для подключения к серверу (мониторинг)
 

